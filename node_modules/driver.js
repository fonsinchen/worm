"use strict";

module.exports = function(shared) {
    return {
        quoteIdentifier : function(identifier) {
            return '"' + identifier.replace('.', '"."') + '"';
        },
        quoteString : function(string) {
            return "'" + string + "'";
        },
        run : function(sql, params, rowCallback, endCallback, errCallback) {
            shared.connect(function(err, client) {
                if (err) {
                    errCallback(err);
                } else {
                    var q = client.query(sql);
                    q.on('row', rowCallback);
                    q.on('end', endCallback);
                }
            });
        }
    }
}