"use strict";

module.exports = function(table, descriptor) {
    var fields = [];
    var rows = [];
    for (var key in descriptor) {
        if (descriptor.hasOwnProperty(key)) {
            if (descriptor[key] === 1) {
                fields.push(key);
            } else {
                // subdescriptors, ignore for now
            }
        }
    }
    
    // TODO parse, create chid descriptors
    return {
        renderFrom : function(driver) {
            return driver.quoteIdentifier(table)
        },
        renderSelect : function(driver) {
            return fields.map(driver.quoteIdentifier).join(', ');
        },
        renderUpdate : function(driver) {},
        renderInsert : function(driver) {},
        renderDelete : function(driver) {}, // semantic is unclear: only delete from master table or from all?
        extract : function(result) {
            rows.push(result);
        }, // called once for each row 
        result : function() {
            return rows;
        } // get the final result
    };
};